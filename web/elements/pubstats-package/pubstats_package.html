<!DOCTYPE html>

<link rel="import" href="../../packages/polymer/polymer.html">
<link rel="import" href="../../packages/core_elements/core_ajax_dart.html">

<polymer-element name="pubstats-package" attributes="name">
    <template>
        <style>
            :host {
                display: block;
                width: 75%;
                margin: 0 auto;
            }

            div {
                display: flex;
                flex-direction: row;
                justify-content: space-between;
            }
        </style>
        <core-ajax-dart auto
                        url="http://localhost:8080/api/packages/{{name}}"
                        handleAs="json"
                        response="{{package}}"></core-ajax-dart>

        <template if="{{package}}">
            <a href="#/packages">Back</a>

            <div>
                <section>
                    <h1>{{package['package']['name']}} ({{package['package']['latest']['version']}})</h1>
                    <h4>Description</h4>
                    <p>{{package['package']['latest']['pubspec']['description']}}</p>
                </section>
                <section>
                    <h4>Homepage</h4>
                    <p><a _href="{{package['package']['latest']['pubspec']['homepage']}}" target="_blank">{{package['package']['latest']['pubspec']['homepage']}}</a></p>
                    <h4>Documentation</h4>
                    <p><a _href="http://www.dartdocs.org/documentation/{{package['package']['name']}}/latest/index.html" target="_blank">http://www.dartdocs.org/documentation/{{package['package']['name']}}/latest/index.html</a></p>
                </section>
            </div>
            <div>
                <section>
                    <h2>Dependencies</h2>
                    <ul>
                        <template repeat="{{dependency in package['package']['latest']['pubspec']['dependencies'].keys | sortIterable}}">
                            <li><a _href="#/packages/{{dependency}}">{{dependency}}</a></li>
                        </template>
                    </ul>
                </section>
                <section>
                    <h2>Dev Dependencies</h2>
                    <ul>
                        <template repeat="{{dev_dependency in package['package']['latest']['pubspec']['dev_dependencies'].keys | sortIterable}}">
                            <li><a _href="#/packages/{{dev_dependency}}">{{dev_dependency}}</a></li>
                        </template>
                    </ul>
                </section>
                <section>
                    <h2>Dependent Packages</h2>
                    <ul>
                        <template repeat="{{dependent in package['dependents']}}">
                            <li><a _href="#/packages/{{dependent}}">{{dependent}}</a></li>
                        </template>
                    </ul>
                </section>

                <section>
                    <h2>Dev Dependent Packages</h2>
                    <ul>
                        <template repeat="{{dev_dependent in package['dev_dependents']}}">
                            <li><a _href="#/packages/{{dev_dependent}}">{{dev_dependent}}</a></li>
                        </template>
                    </ul>
                </section>
            </div>
        </template>
    </template>
    <script type="application/dart" src="pubstats_package.dart"></script>
</polymer-element>
